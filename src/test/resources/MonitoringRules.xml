<monitoringRules
	xmlns="http://www.modaclouds.eu/xsd/1.0/monitoring_rules_schema"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.modaclouds.eu/xsd/1.0/monitoring_rules_schema">
	<monitoringRule timeWindow="30" timeStep="30" id="cpuRule">
		<monitoredTargets>
			<monitoredTarget class="VM" type="Frontend" />
		</monitoredTargets>
		<collectedMetric metricName="CpuUtilization">
			<parameter name="samplingProbability">1</parameter>
			<parameter name="samplingTime">10</parameter>
		</collectedMetric>
		<metricAggregation aggregateFunction="Average"
			groupingClass="VM" />
		<actions>
			<action name="OutputMetric">
				<parameter name="metric">FrontendCPUUtilization</parameter>
				<parameter name="value">METRIC</parameter>
				<parameter name="resourceId">ID</parameter>
			</action>
		</actions>
	</monitoringRule>
	<monitoringRule timeWindow="30" timeStep="30" id="respTimeRule">
		<monitoredTargets>
			<monitoredTarget class="Method" type="answerQuestions" />
			<monitoredTarget class="Method" type="saveAnswers" />
			<monitoredTarget class="Method" type="register" />
		</monitoredTargets>
		<collectedMetric metricName="ResponseTime">
			<parameter name="samplingProbability">1</parameter>
		</collectedMetric>
		<metricAggregation aggregateFunction="Average"
			groupingClass="Method" />
		<actions>
			<action name="OutputMetric">
				<parameter name="metric">AverageRespTime</parameter>
				<parameter name="value">METRIC</parameter>
				<parameter name="resourceId">ID</parameter>
			</action>
		</actions>
	</monitoringRule>
	<monitoringRule id="EffectiveResponseTimeRule"
        startEnabled="true" timeStep="60" timeWindow="60">
        <monitoredTargets>
            <monitoredTarget class="Method" type="login"/>
            <monitoredTarget class="Method" type="register"/>
            <monitoredTarget class="Method" type="logout"/>
        </monitoredTargets>
        <collectedMetric metricName="EffectiveResponseTime">
            <parameter name="samplingProbability">1</parameter>
        </collectedMetric>
        <actions>
            <action name="OutputMetric">
                <parameter name="resourceId">AllMethods</parameter>
                <parameter name="metric">AverageEffectiveResponseTime</parameter>
                <parameter name="value">SUM(METRIC)/COUNT(METRIC)</parameter>
            </action>
        </actions>
    </monitoringRule>
    <monitoringRule id="RestCallRule"
        startEnabled="true" timeStep="5" timeWindow="5">
        <monitoredTargets>
            <monitoredTarget class="Method" type="register"/>
        </monitoredTargets>
        <collectedMetric metricName="ResponseTime">
            <parameter name="samplingProbability">1</parameter>
        </collectedMetric>
        <metricAggregation aggregateFunction="Average" groupingClass="Method"/>
        <actions>
            <action name="RestCall">
                <parameter name="url">http://localhost:8170/v1/monitoring-rules/RestCallRule</parameter>
                <parameter name="method">DELETE</parameter>
            </action>
        </actions>
    </monitoringRule>
</monitoringRules>